# 현실에서의 함수형 사고

이번 Chapter 02에서는 피자 사업을 예시로 함수형 프로그래밍에서 중요한 두 부분을 대략적으로 살펴본다.

## 파트1. 액션과 계산, 데이터

[Chapter 01](/books%2F%EC%8F%99%EC%8F%99%2520%EB%93%A4%EC%96%B4%EC%98%A4%EB%8A%94%2520%ED%95%A8%EC%88%98%ED%98%95%2520%EC%BD%94%EB%94%A9%2FChapter%252001)에서 함수형 프로그래밍에서 코드를 세 분류, 액션과 계산 그리고 데이터로 나누는 것을 알아봤다. 함수형 프로그래밍에서는 실제로 이런 용어를 사용하지 않더라도. 이런 기준으로 나누는 것이 중요하다.

### 변경 가능성에 따라 코드 나누기

함수형 프로그래밍에서는 코드를 변경할 때 드는 비용을 줄이기 위해 변경 가능성에 따라 코드를 나눌 수 있다. 아래는 피자 사업 소프트웨어를 예로 든 계층형 설계이다.

| 피자 주방 레이어 | 창고 레이어        | 메인 레이어   |
| :--------------- | :----------------- | :------------ |
| 이번 주 메뉴     | 이번 주 사야 할 것 | 비즈니스 규칙 |
| 피자 만들기      | 재료 목록          | 도메인 규칙   |
| 자바스크립트     | 자바스크립트       | 기술 스택     |

위 부터 아래로 내려갈 수록 자주 바뀌지 않는 것이며 각 항목은 아래에 있는 것을 기반으로 구현된다.

🤔 계층형 설계에 대한 내용은 Chapter 08 ~ 09 에서 자세히 설명한다.

## 파트2. 일급 추상

현재 피자 가게에는 피자를 만드는 로봇이 한 대 있고 아래는 피자 하나를 만드는 액션이다.

| 로봇 1        |
| :------------ |
| 주문접수      |
| 반죽만들기    |
| 반죽 펴기     |
| 소스 만들기   |
| 소스 뿌리기   |
| 치즈 갈기     |
| 치즈 뿌리기   |
| 오븐에 넣기   |
| 10분 기다리기 |
| 서빙          |

로봇은 반드시 이 순서대로 피자를 만들어야 한다. 이때 피자를 더 많이, 빠르게 만들기 위해 로봇 세 대가 같이 피자를 만들게 했다.

**주문 접수**

| 로봇 1     | 로봇 2    | 로봇 3        |
| :--------- | :-------- | :------------ |
| 반죽만들기 | 치즈 갈기 | 소스 만들기   |
|            |           | 반죽 펴기     |
|            |           | 소스 뿌리기   |
|            |           | 치즈 뿌리기   |
|            |           | 오븐에 넣기   |
|            |           | 10분 기다리기 |
|            |           | 서빙          |

이렇게 로봇 여러 대가 함께 일하는 것은 분산 시스템을 의미하는데 이때 각 액션의 실행 순서가 섞일 수 있다는 문제가 있다. 따라서 이상한 피자가 만들어질 수 있다는 것.

### 타임라인 커팅

액션에 순서가 보장되지 않는 문제를 해결하기 위해 커팅 이라는 기술 쓸 수 있다.

🤔 타임라인 커팅 내용은 Chapter 17 에서 자세히 설명한다.

타임라인 커팅은 고차 동작으로 구현할 수 있는데 각 액션은 독립적으로 동작하되 작업이 끝나면 다른 액션이 끝나기를 기다렸다가 이후 다음 액션이 동작하도록 한다.

#### 고차 동작

고차 동작은 함수를 인수로 받아 사용하는 고차 함수로 만든 동작을 말한다.
🤔 고차 함수는 Chapter 10 에서 자세히 설명한다.
