# URL과 리소스

URL은 브라우저가 정보를 찾는데 필요한 리소스의 위치를 가리킨다. 따라서 이 URL로 인터넷에 있는 엄청난 리소스를 찾고 공유할 수 있는 것이다.

> http://www.jose-hardware.com/seasonal/index-fall.html

위 주소를 보면

-   `http`는 URL의 스킴이라고 불리는 것으로 웹 클라이언트가 리소스에 어떻게 접근하는 지 알려준다.
-   `www.jose-hardware.com`은 서버의 위치로 리소스가 어디에 있는지 알려준다.
-   `/seasonal/index-fall.html`은 리소스의 경로로 서버에 있는 리소스 중 어떤 리소스를 요청받은 것인지 알려준다.

이때 URL의 스킴으로 http 말고 mailto, ftp, rtsp 등을 사용할 수도 있다.

## URL 문법

> <스킴>://<사용자 이름>:<비밀번호>@<호스트>:<포트>/<경로>;<파라미터>?<질의>#프래그먼트

URL 문법은 이렇게 총 9부분으로 나뉘는데 이를 모두 포함하는 URL은 거의 없고 가장 중요한 것은 스킴, 호스트, 경로다.

### 스킴

위에서 설명했듯이 사용할 프로토콜을 알려준다.

### 호스트와 포트

여기서 호스트는 www.jose-hardware.com의 형태일 수도 161.58.228.45와 같은 IP 형태일 수도 있다. 둘 다 호스트 서버의 위치를 가리킨다.
호스트 뒤에 :(콜론)을 붙여 포트를 붙이기도 하는데 서버가 열어놓은 포트를 가리킨다. TCP 프로토콜을 사용하는 HTTP는 기본값이 80이다.

### 사용자 이름과 비밀번호

URL에 사용자 이름, 비밀번호가 들어가기도 하는데 FTP 서버가 좋은 예다
ftp://anonymous:my_password@ftp.prep.ai.mit.edu/pub/gun

### 경로

경로는 /seasonal/index-fall.html 이와 같은 형태로 리소스의 위치를 찾는데 사용하는 정보다 /를 기준으로 경로 조각이 나뉜다.

### 파라미터

호스트, 경로만으로 필요한 리소스를 찾을 수 없는 경우도 있다. 여러 프로토콜이 보다 더 많은 정보를 요구하기도 하는데 이때 ;로 구분하여 이름=값 형태로 아래 처럼 필요한 추가 정보를 전달할 수 있다.

ftp://prep.ai.mit.edu/pub/gnu;type=d

### 질의 문자열

보통 쿼리스트링이라고 부르던 부분인데 URL에서 물음표(?) 오른쪽에 있는 값들이며 이 역시 파라미터와 마찬가지로 이름=값 형태를 띄고 있으며 이는 &를 기준으로 나뉜다.

http://www.jose-hardware.com/inventory-check.cgi?item=12731&color=blue

### 프래그먼트

HTML 같은 리소스의 경우 HTML 문서의 특정 부분을 가리킬 수 있도록 URL의 끝에 #위치 형식으로 표현한다. 이때 클라이언트는 프래그먼트를 서버에 전달하지 않고 서버로부터 받은 HTML 문서를 받은 후 프래그먼트를 사용하여 문서의 일부분을 보여준다.

http://www.hose-hardware.com/tools.html#drills

## 단축 URL

위에서 본 내용들은 모두 URL 전체를 나타낸 것인데 이것 말고도 URL을 표현하는 방법이 있다.

### 상대 URL

http://www.jose-hardware.com/tools.html 이 가리키는 HTML 문서 내에 `./hammers.html`을 카리키는 하이퍼 링크가 있다고 하자. 이것은 잘 알고 있는 상대경로로 현재 HTML 리소스 위치를 기준으로 해석되는 URL이다. 따라서 이는 http://www.jose-hardware.com/hammers.html로 해석된다.

### URL 확장

브라우저는 URL을 입력한 다음, 입력하는 동안에 자동으로 URL을 확장한다. 예를들면 jose-hardware만 입력해서 www.jose-hardware.com을 만들어주는 호스트 명 확장이나 이전에 사용자가 방문했던 URL 기록을 저장해놓고 자동 완성해주는 히스토리 확장 등이 있다.

## 안전하지 않은 문자

URL 설계자들은 모든 상대적으로 작고 안전한 알파벳 문자만 URL에 포함할 수 있게 허락했다. 이때 가독성도 중요했기 때문에 출력이 되지 않거나 보이지 않는 문자들은 포함할 수 없게 했다. 뿐만 아니라 알파벳 외의 문자를 포함하는 경우도 있었기 때문에 이스케이프 기능을 추가하여 안전하지 않은 문자를 안전한 문자로 인코딩할 수 있게 했다.

### URL 문자 집합

#### 인코딩 체계

안전함을 챙기고 표현의 한계를 넘기 위해 URL에 안전하지 않은 문자들을 표현할 수 있는 인코딩방식이 고안되었는데 이는 안전하지 않은 문자를 %로 시작해 ASCII 코드로 표현되는 두 개의 16진수 숫자로 이루어진 이스케이프 문자로 바꾼다.

| 문자   | ASCII 코드 | URL의 예                                             |
| ------ | ---------- | ---------------------------------------------------- |
| ~      | 126(0x7E)  | http://www.jose-hardwear.com/%Ejoe                   |
| 빈문자 | 32(0x20)   | http://www.jose-hardwear.com/more%20tools.html       |
| %      | 37(0x25)   | http://www.jose-hardwear.com/100%25satisfaction.html |

#### 문자 제한

몇몇 문자는 URL에서 특별한 의미로 사용되기 때문에 이 문자들은 URL에서 약속된 용도 말고 다른 용도로 쓰려면 반드시 인코딩을 해야한다.

| 문자             | 선점 및 제한                                                           |
| ---------------- | ---------------------------------------------------------------------- |
| %                | 인코딩된 문자에 사용할 이스케이프 토큰                                 |
| /                | 경로 컴포넌트에 있는 경로 세그먼트를 나누는 용도로 선점                |
| .                | 경로 컴포넌트에서 선점                                                 |
| ..               | 경로 컴포넌트에서 선점                                                 |
| #                | 프래그먼트의 구획 문자로 선점                                          |
| ?                | 질의 문자열의 구획 문자로 선점                                         |
| ;                | 파라미터의 구획 문자로 선점                                            |
| :                | 스킴, 사용자 이름/비밀번호, 호스트/포트의 구획 문자로 선점             |
| $ , +            | 선점                                                                   |
| @ & =            | 특정 스킴에서 특별한 의미가 있기 때문에 선점                           |
| {} · \| \ ~ [] ` | 게이트웨이와 같은 여러 전송 에이전트에서 불안전하게 다루기 때문에 재한 |
| <> "             | 안전하지 않음                                                          |
| 0x00-0x1F, 0x7F  | 인쇄되지 않는 US-ASCII 문자이므로 제한                                 |
| 0x7F             | 7비트 US-ASCII 문자가 아니므로 제한                                    |
